{% extends "task/task_base.html" %}

{% block pre %}
    <div class="card">
  <h4 class="card-header">{{ task_details.name }}</h4>
     <div class="card-body">
            <a href="{% url 'project:detail' pk=task_details.projectBacklog.project.pk %}">project {{ task_details.projectBacklog.project.name }} </a>
            <p>description: {{ task_details.description }}</p>
            <p>priority: {{ task_details.priority }}</p>
            <p>task type: {{ task_details.task_type }}</p>
            {% if  task_details.parent_fields %}s
                <p>parent task: {{ task_details.parent_fields }}</p>
            {% endif %}
            {% if  task_details.link_task %}
                <p>parent task: {{ task_details.link_task }}</p>
            {% endif %}
            {% if  task_details.team %}
                <p>Assign to : {{ task_details.team }}</p>
            {% else %}
                Not assigned to any team yet
            {% endif %}

            {% if task_details.taskProperty %}
                <p>sprint: {{ task_details.taskProperty.sprint }}</p>
                <p>assign to : {{ task_details.taskProperty.assign_to }}</p>
                <p>started at : {{ task_details.taskProperty.start_date }}</p>
                {% if task_details.taskProperty.end_date %}
                    <p>ended at : {{ task_details.taskProperty.end_date }}</p>
                {% else %}
                    <p>in progress</p>
                {% endif %}
                {% if task_details.task_completed is false %}
                 <a href="{% url 'task:finished' pk=task_details.pk %}" class="btn btn-md btn-fill btn-warning"><span
                        class="glyphicon glyphicon-ok"></span> Mark as finished</a>
                    {% endif %}

                    <a href="{% url 'log:create' pk=task_details.taskProperty.pk %}" class="btn btn-md btn-fill btn-warning"><span
                        class="glyphicon glyphicon-plus-sign"></span> Add log</a>


            {% else %}
                <a href="{% url 'task:procreate' pk=task_details.pk %}" class="btn btn-md btn-fill btn-warning"><span
                        class="glyphicon glyphicon-plus-sign"></span> Assign task</a>
            {% endif %}

                <a href="{% url 'task:update' pk=task_details.pk %}" class="btn btn-md btn-fill btn-warning"><span
            class="glyphicon glyphicon-plus-sign"></span> Edit task</a>

</div>
</div>
{% endblock %}


{% block post %}

    {% if task_details.taskProperty %}
        {% if task_details.taskProperty.log4tasks.count %}
            <div class="row"><div class="list-group">
            {% for log in  task_details.taskProperty.log4tasks.all%}


                {% include "log/_log.html" %}


            {% endfor %}
            </div></div>
        {% endif %}
    {% endif %}
{% endblock %}